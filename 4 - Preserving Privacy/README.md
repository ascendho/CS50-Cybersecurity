# Preserving Privacy

## 一、课程概述
- **课程主题**：聚焦隐私保护核心，揭露网页浏览中隐藏的信息泄露风险（如追踪、日志记录），并提供实用的隐私防护方法，核心是“掌控信息共享边界”。
- **主讲人**：David J. Malan（哈佛大学）
- **核心目标**：理解隐私泄露的主要途径（浏览历史、Cookie、指纹识别等），掌握浏览器设置、工具应用等隐私防护技巧，减少未授权的信息共享。

## 二、隐私泄露的核心途径
### 1. 网页浏览历史（Web Browsing History）
- **泄露风险**：
  - 浏览器本地存储浏览记录，即使手动清除，服务器仍会保留访问日志（含IP地址、访问时间、请求内容等）。
  - 服务器日志示例格式：`$remote_addr - $remote_user [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent"`，包含用户核心访问信息。
- **关键认知**：清除本地浏览历史无法删除服务器端日志，仅能保护本地设备上的隐私。

### 2. HTTP头（HTTP Headers）
- **核心泄露点**：
  - Referer头：自动向目标网站传递“来源页面”信息，如从Google搜索“cats”跳转时，传递`Referer: https://www.google.com/search?q=cats`，泄露搜索关键词。
  - User-Agent头：暴露设备型号、操作系统版本、浏览器类型，如`Mozilla/5.0 (Linux; Android 13) AppleWebKit/537.36 Chrome/110.0.0.0 Mobile Safari/537.36`。
- **防护设置**：
  - 限制Referer传递范围：在网站添加`<meta name="referrer" content="origin">`，仅传递来源网站域名（如`https://www.google.com/`），不包含具体路径/参数。
  - 完全禁止Referer：添加`<meta name="referrer" content="none">`，不传递任何来源信息。

### 3. 指纹识别（Fingerprinting）
- **原理**：第三方通过收集设备/浏览器的“特征组合”唯一标识用户，即使隐藏IP或清除Cookie也能追踪。
- **核心特征**：IP地址、屏幕分辨率、浏览器扩展、安装字体、操作系统版本、User-Agent等。
- **风险**：特征组合具有唯一性，长期积累后可精准定位用户身份，难以规避。

### 4. Cookie相关追踪
Cookie是服务器存储在用户设备上的小型数据，核心分为4类，均存在隐私泄露风险：

| Cookie类型 | 定义与特点 | 泄露风险 |
|------------|------------|----------|
| 会话Cookie（Session Cookies） | 临时存储，标识用户会话（如登录状态），服务器设定过期时间 | 泄露当前会话状态，如登录身份 |
| 追踪Cookie（Tracking Cookies） | 长期有效（如2年），用于追踪用户跨时间的行为（如Google Analytics的`_ga` Cookie） | 记录用户长期浏览习惯，用于广告推送 |
| 第三方Cookie（Third-Party Cookies） | 由非当前访问网站的第三方服务器设置（如广告商），跨网站追踪 | 追踪用户在不同网站的浏览轨迹，构建完整行为画像 |
| 超级Cookie（Supercookies） | 由互联网服务提供商（ISP）注入HTTP头，用户无感知 | 强制追踪所有网络行为，难以手动清除 |

### 5. 追踪参数（Tracking Parameters）
- **原理**：嵌入URL中的可见参数（如`click_id`、`user_id`），用于精准追踪用户来源和行为。
- **示例**：`https://example.com/ad?click_id=YmVhODI1MmZmNGU4`，`click_id`唯一标识该用户的点击行为。
- **现状**：部分浏览器已自动清理此类参数（如仅保留`campaign_id`，删除`click_id`），减少精准追踪。

### 6. DNS查询（Domain Name System）
- **泄露风险**：传统DNS查询未加密，ISP和DNS服务商可直接获取用户访问的网站域名（如`harvard.edu`），暴露浏览意图。
- **核心问题**：DNS是域名解析的必经环节，未加密时相当于“公开告知”所有访问目标。

## 三、隐私防护实用方法
### 1. 私人浏览（Private Browsing）
- **作用**：打开独立浏览窗口，不使用过往Cookie，关闭后清除当前会话的Cookie和浏览记录。
- **局限性**：
  - 仍会产生新Cookie，服务器可追踪当前会话内的行为。
  - 无法隐藏IP地址，ISP和服务器仍能记录访问日志。

### 2. DNS加密
- **解决方案**：使用DNS over HTTPS（DoH）或DNS over TLS（DoT），加密DNS查询数据，防止ISP或第三方窃取域名信息。
- **核心价值**：仅暴露IP地址，不暴露具体访问的网站域名，保护浏览意图。

### 3. 虚拟专用网络（VPN）
- **防护逻辑**：在用户设备与VPN服务器间建立加密通道，所有网络请求通过VPN服务器转发，对外暴露VPN服务器的IP地址，隐藏真实IP。
- **局限性**：
  - 无法防护设备已感染的恶意软件（如键盘记录器）。
  - 依赖VPN服务商的可信度，不可信服务商可能记录用户行为。

### 4. Tor浏览器

- **防护逻辑**：通过多层加密的Tor节点转发网络请求，隐藏真实IP和地理位置，节点间仅传递加密数据，无法追踪用户来源。
- **局限性**：
  - 浏览速度较慢（多节点转发）。
  - 若本地网络中仅少数人使用Tor，可能通过其他方式（如设备特征）间接识别。

### 5. 权限管理（Permissions）
- **核心原则**：谨慎授予设备权限，尤其是隐私敏感权限（如位置信息、摄像头、麦克风）。
- **示例**：位置服务默认暴露实时地理坐标，非必要时关闭，避免地图类应用持续追踪位置。

## 四、关键总结与注意事项
1. 隐私泄露是“多环节叠加”的结果：单一防护（如清除Cookie）无法完全避免追踪，需组合使用多种方法。
2. 无绝对隐私防护：任何技术（如Tor、VPN）都有局限性，核心是“降低追踪精度”而非“完全匿名”。
3. 主动控制信息共享：通过浏览器设置（Referer限制、清除Cookie）、工具（DoH、VPN）、权限管理，减少不必要的信息暴露。
4. 警惕隐形追踪：超级Cookie、DNS查询、指纹识别等非可见追踪手段，需通过技术工具（如加密DNS、反指纹浏览器）防护。
5. 服务器日志不可规避：即使采取多重防护，服务器仍会记录访问行为，敏感操作（如转账）需选择可信平台。